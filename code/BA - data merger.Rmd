---
title: "R Notebook"
output: html_notebook
editor_options: 
  markdown: 
    wrap: 72
---

```{r}
library(tidyverse)
```

# Load data

```{r}
women_in_parliament <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/women_in_parliament.csv",show_col_types = FALSE)
basic_sanitation <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/basic_sanitation.csv",show_col_types = FALSE)
basic_water_source <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/basic_water_source.csv",show_col_types = FALSE)
electricity <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/electricity.csv",show_col_types = FALSE)
employment_rate <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/employment_rate.csv",show_col_types = FALSE)
material_footprint <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/material_footprint.csv",show_col_types = FALSE)
forest_area <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/forest_area.csv",show_col_types = FALSE)
mean_years_in_school <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/mean_years_in_school.csv",show_col_types = FALSE)
air_pollution <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/air_pollution.csv",show_col_types = FALSE)
health_worker <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/health_worker.csv",show_col_types = FALSE)
red_list <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/red_list.csv",show_col_types = FALSE)
poverty <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/poverty.csv",show_col_types = FALSE)
life_expectancy <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/life_expectancy.csv",show_col_types = FALSE)
income <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/income.csv",show_col_types = FALSE)
income_share_20 <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/income_share_20.csv",show_col_types = FALSE)
CO2 <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/CO2.csv",show_col_types = FALSE)
murder <- read_csv("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/preprocessed_data/murder.csv",show_col_types = FALSE)
```

# General information about data sets

```{r}
# titles <- c(
# "women_in_parliament",
# "basic_sanitation",
# "basic_water_source",
# "electricity",
# "employment_rate",
# "material_footprint",
# "forest_area",
# "mean_years_in_school",
# "air_pollution",
# "health_worker",
# "red_list",
# "poverty",
# "life_expectancy",
# "income",
# "income_share_20",
# "CO2",
# "murder"
# )
# 
# earliest <- c(
# min(women_in_parliament$year),
# min(basic_sanitation$year),
# min(basic_water_source$year),
# min(electricity$year),
# min(employment_rate$year),
# min(material_footprint$year),
# min(forest_area$year),
# min(mean_years_in_school$year),
# min(health_worker$year),
# min(air_pollution$year),
# min(red_list$year),
# min(poverty$year),
# min(life_expectancy$year),
# min(income$year),
# min(income_share_20$year),
# min(CO2$year),
# min(murder$year)
# )
# 
# latest <- c(
# max(women_in_parliament$year),
# max(basic_sanitation$year),
# max(basic_water_source$year),
# max(electricity$year),
# max(employment_rate$year),
# max(material_footprint$year),
# max(forest_area$year),
# max(mean_years_in_school$year),
# max(health_worker$year),
# max(air_pollution$year),
# max(red_list$year),
# max(poverty$year),
# max(life_expectancy$year),
# max(income$year),
# max(income_share_20$year),
# max(CO2$year),
# max(murder$year)
# )
# 
# datapoints <- c(
# nrow(women_in_parliament),
# nrow(basic_sanitation),
# nrow(basic_water_source),
# nrow(electricity),
# nrow(employment_rate),
# nrow(material_footprint),
# nrow(forest_area),
# nrow(mean_years_in_school),
# nrow(air_pollution),
# nrow(health_worker),
# nrow(red_list),
# nrow(poverty),
# nrow(life_expectancy),
# nrow(income),
# nrow(income_share_20),
# nrow(CO2),
# nrow(murder)
# )
# 
# dps_1990_2020 <- c(
# nrow(subset(women_in_parliament, year %in% c(1990:2020))),
# nrow(subset(basic_sanitation, year %in% c(1990:2020))),
# nrow(subset(basic_water_source, year %in% c(1990:2020))),
# nrow(subset(electricity, year %in% c(1990:2020))),
# nrow(subset(employment_rate, year %in% c(1990:2020))),
# nrow(subset(material_footprint, year %in% c(1990:2020))),
# nrow(subset(forest_area, year %in% c(1990:2020))),
# nrow(subset(mean_years_in_school, year %in% c(1990:2020))),
# nrow(subset(air_pollution, year %in% c(1990:2020))),
# nrow(subset(health_worker, year %in% c(1990:2020))),
# nrow(subset(red_list, year %in% c(1990:2020))),
# nrow(subset(poverty, year %in% c(1990:2020))),
# nrow(subset(life_expectancy, year %in% c(1990:2020))),
# nrow(subset(income, year %in% c(1990:2020))),
# nrow(subset(income_share_20, year %in% c(1990:2020))),
# nrow(subset(CO2, year %in% c(1990:2020))),
# nrow(subset(murder, year %in% c(1990:2020)))
# )
# 
# 
# zero_or_below <- c(
# (min(women_in_parliament$value, na.rm = TRUE) <= 0),
# (min(basic_sanitation$value, na.rm = TRUE) <= 0),
# (min(basic_water_source$value, na.rm = TRUE) <= 0),
# (min(electricity$value, na.rm = TRUE) <= 0),
# (min(employment_rate$value, na.rm = TRUE) <= 0),
# (min(material_footprint$value, na.rm = TRUE) <= 0),
# (min(forest_area$value, na.rm = TRUE) <= 0),
# (min(mean_years_in_school$value, na.rm = TRUE) <= 0),
# (min(air_pollution$value, na.rm = TRUE) <= 0),
# (min(health_worker$value, na.rm = TRUE) <= 0),
# (min(red_list$value, na.rm = TRUE) <= 0),
# (min(poverty$value, na.rm = TRUE) <= 0),
# (min(life_expectancy$value, na.rm = TRUE) <= 0),
# (min(income$value, na.rm = TRUE) <= 0),
# (min(income_share_20$value, na.rm = TRUE) <= 0),
# (min(CO2$value, na.rm = TRUE) <= 0),
# (min(murder$value, na.rm = TRUE) <= 0)
# )
# 
# dp_per_year <- datapoints / (latest - earliest)
# 
# overview <- data.frame(titles, earliest, latest, dps_1990_2020, datapoints, dp_per_year, zero_or_below)
# overview[order(overview$dps_1990_2020, decreasing = TRUE),]
# 
# write_csv(overview, "D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/raw_data/overview.csv")
```

Using data sets that have values of 0 or less might be an issue later on
when inputting the data into the DEA, unless the 0 values get filtered
out anyways while merging.

# Functions

```{r}
merger <- function(indicators) {
  d <- general[c("dmu", indicators)]
  d <- drop_na(d)
  d
}

merger2 <- function(indicators) {
  d <- reduce(indicators, full_join, by="dmu")
  drop_na(d)
}


write_final <- function(final) {
  write_csv(final, paste("D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/processed_data/", deparse(substitute(final)), ".csv", sep = ""))
}


check0 <- function(data) {
  
  sum(data <= 0)

  # if (data$women_in_parliament) {
  #   a <- min(data$women_in_parliament)
  # }
  # 
  # if (data$forest_area) {
  #   b <- min(data$forest_area)
  # }
  # 
  # if (data$mean_years_in_school) {
  #   c <- min(data$mean_years_in_school)
  # }
  # 
  # if (data$poverty) {
  #   d <- min(data$poverty)
  # }
  # 
  # if (data$CO2) {
  #   e <- min(data$CO2)
  # }

}




```

# Merge data frames

We want to create multiple data sets all comprising a different set of
data sets. Merging all data sets results in too less dmus and too many
dimensions and this results in all DMUs having an efficiency of either 1
or very close to 1. The plan is to check, which combination of around 4
in and 4 outputs results in a high enough number of DMUs.

We want as many DMUs as possible. Therefore, it makes sense to use data
sets with large time periods (e.g. women_in_parliament) and many
datapoints (e.g. life_expectency, CO2, income).

The amount of data point of the data set with the most data points
automatically represents the maximum number of potential DMUs.

Data sets that we can ignore already because of too little time frames
and too few data points:

-   air_pollution

-   basic_sanitation

-   basic_water_source

Data sets that (as of now) look very promising:

-   women_in_parliament

-   life_expectancy

-   income

-   CO2

## General data frame

17 in total

```{r}
# Create list of all data frames
# all_data <- list(
#   women_in_parliament,
#   basic_sanitation,
#   basic_water_source,
#   electricity,
#   employment_rate,
#   material_footprint,
#   forest_area,
#   mean_years_in_school,
#   health_worker,
#   air_pollution,
#   red_list,
#   poverty,
#   life_expectancy,
#   income,
#   income_share_20,
#   CO2,
#   murder
# )
```

```{r}

# Merge all data frame together by the country attribute

# general <- all_data %>% reduce(full_join, by="dmu")
```

Merge with merge function

```{r}
general <- 
  merge(
  merge(
  merge(
  merge(
  merge(
  merge(
  merge(
  merge(
  merge(
  merge(
  merge(
  merge(
  merge(
  merge(
  merge(
  merge(
    
  women_in_parliament,
  basic_sanitation, by = "dmu", all = TRUE),
  basic_water_source, by = "dmu", all = TRUE),
  electricity, by = "dmu", all = TRUE),
  employment_rate, by = "dmu", all = TRUE),
  material_footprint, by = "dmu", all = TRUE),
  forest_area, by = "dmu", all = TRUE),
  mean_years_in_school, by = "dmu", all = TRUE),
  air_pollution, by = "dmu", all = TRUE),
  health_worker, by = "dmu", all = TRUE),
  red_list, by = "dmu", all = TRUE),
  poverty, by = "dmu", all = TRUE),
  life_expectancy, by = "dmu", all = TRUE),
  income, by = "dmu", all = TRUE),
  income_share_20, by = "dmu", all = TRUE),
  CO2, by = "dmu", all = TRUE),
  murder, by = "dmu", all = TRUE)
                                  

```

```{r}

# Change column names to something meaningful
colnames(general) <- c(
  "dmu",
  "women_in_parliament",
  "basic_sanitation",
  "basic_water_source",
  "electricity",
  "employment_rate",
  "material_footprint",
  "forest_area",
  "mean_years_in_school",
  "air_pollution",
  "health_worker",
  "red_list",
  "poverty",
  "life_expectancy",
  "income",
  "income_share_20",
  "CO2",
  "murder"
  )

# convert tibble to data frame
general <- as.data.frame(general)
```

```{r}
write_csv(general, "D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/processed_data/general.csv")
```

## Attempt 18 - 2 datasets

| Input         | Output          |
|---------------|-----------------|
| health_worker | income_share_20 |

```{r}
final_18 <- merger(c(
  "health_worker",
  "income_share_20"
))

nrow(final_18)

write_final(final_18)
```

-\> dmus

```{write_final(final_18)}
```

## Attempt 17 - 2 datasets

| Input       | Output          |
|-------------|-----------------|
| electricity | income_share_20 |

```{r}
final_17 <- merger(c(
  "electricity",
  "income_share_20"
))

nrow(final_17)
```

-\> **1640** dmus

```{r}
check0(final_17)
```

No 0 values

```{r}
write_final(final_17)
```

## Attempt 16 - 2 datasets

| Input       | Output  |
|-------------|---------|
| electricity | poverty |

```{r}
final_16 <- merger(c(
  "electricity",
  "poverty"
))

nrow(final_16)
```

-\> **1645** dmus

**Check for 0 values**

```{r}
# min(final_16$women_in_parliament)
# min(final_16$forest_area)
# min(final_16$mean_years_in_school)
min(final_16$poverty)
# min(final_16$CO2)
```

```{r}
check0(final_16)
```

Poverty has too many 0 values -\> next attempt with lower income

## Attempt 15 - 2 datasets

| Input                | Output          |
|----------------------|-----------------|
| mean_years_in_school | employment_rate |

```{r}
final_15 <- merger(c(
  "mean_years_in_school",
  "employment_rate"
))

nrow(final_15)
```

-\> **4475** dmus

```{r}
# min(final_15$women_in_parliament)
# min(final_15$forest_area)
min(final_15$mean_years_in_school)
# min(final_15$poverty)
# min(final_15$CO2)
```

no 0 values :)

**Export to csv**

```{r}
write_final(final_15)
```

## Attempt 14 - 2 datasets

| Input | Output               |
|-------|----------------------|
| CO2   | mean_years_in_school |

```{r}
final_14 <- merger(c(
  "CO2",
  "mean_years_in_school"
))

nrow(final_14)
```

-\> **5892** DMUs

**Check for 0 values**

```{r}
# min(final_14$women_in_parliament)
# min(final_14$forest_area)
min(final_14$mean_years_in_school)
# min(final_14$poverty)
min(final_14$CO2)
```

0 values in mean_years_in_school

```{r}
check0(final_14)
```

2 entry with 0 mean years in school -\> delete

```{r}
final_14 <- filter(final_14, mean_years_in_school != 0)
```

**Export to csv**

```{r}
write_final(final_14)
```

## Attempt 13 - 2 datasets

| Input | Output |
|-------|--------|
| CO2   | income |

```{r}
final_13 <- merger(c(
  "CO2",
  "income"
))

nrow(final_13)
```

-\> **12446** dmus

**Check for 0 values**

```{r}
# min(final_13$women_in_parliament)
# min(final_13$forest_area)
# min(final_13$mean_years_in_school)
# min(final_13$poverty)
min(final_13$CO2)
```

0 values in CO2

```{r}
check0(final_13)
```

6 entries with 0 CO2 -\> delete

```{r}
final_13 <- filter(final_13, CO2 != 0)
```

**Export to csv**

```{r}
write_final(final_13)
```

## Attempt 12 - 2 datasets

| Input | Output              |
|-------|---------------------|
| CO2   | women_in_parliament |

```{r}
final_12 <- merger(c(
  "CO2",
  "women_in_parliament"
))

nrow(final_12)
```

-\> **8847** dmus

**Check for 0 values**

```{r}
min(final_12$women_in_parliament)
# min(final_12$forest_area)
# min(final_12$mean_years_in_school)
# min(final_12$poverty)
min(final_12$CO2)
```

```{r}
check0(final_12)
```

600 values in CO2. 2 in CO2 column, 598 in women_in_parliament

```{r}
final_12 <- filter(final_12, CO2 > 0)
final_12[final_12 == 0] <- 0.001
```

**Export to csv**

```{r}
write_final(final_12)
```

## Attempt 11 - 5 data sets

| Input                | Output          |
|----------------------|-----------------|
| employment_rate      | life_expectancy |
| mean_years_in_school | income          |
|                      | CO2             |

**Merge data**

```{r}
final_11 <- merger(c(
  "employment_rate",
  "mean_years_in_school",
  "CO2",
  "life_expectancy",
  "income"
))

nrow(final_11)
```

-\> **4473** DMUs

**Check for 0 values**

```{r}
# min(final_11$women_in_parliament)
# min(final_11$forest_area)
min(final_11$mean_years_in_school)
# min(final_11$poverty)
min(final_11$CO2)
```

No 0 values

**Export to csv**

```{r}
write_final(final_11)
```

## Attempt 10 - 3 data sets

| Input                | Output          |
|----------------------|-----------------|
| mean_years_in_school | life_expectancy |
|                      | income          |

**Merge data**

```{r}
final_10 <- merger(c(
  "mean_years_in_school",
  "life_expectancy",
  "income"
))

nrow(final_10)
```

-\> **5942** DMUs

**Check for 0 values**

```{r}
# min(final_10$women_in_parliament)
# min(final_10$forest_area)
min(final_10$mean_years_in_school)
# min(final_10$poverty)
# min(final_10$CO2)
```

Mean years in school has values of 0

```{r}
check0(final_10)

```

Only one entry of Yemen -\> delete it

```{r}
final_10 <- subset(final_10, (mean_years_in_school != 0))
```

**Export to csv**

```{r}
write_final(final_10)
```

## Attempt 9 - 5 data sets

| Input                | Output          |
|----------------------|-----------------|
| employment_rate      | life_expectancy |
| mean_years_in_school | income          |
|                      | CO2             |

**Merge data**

```{r}
final_9 <- merger(c(
  "employment_rate",
  "mean_years_in_school",
  "CO2",
  "life_expectancy",
  "income"
))

nrow(final_9)
```

-\> **4473** DMUs

**Check for 0 values**

```{r}
# min(final_9$women_in_parliament)
# min(final_9$forest_area)
min(final_9$mean_years_in_school)
# min(final_9$poverty)
min(final_9$CO2)
```

No values of 0 or below

**Export to csv**

```{r}
write_final(final_9)
```

## Attempt 8 - 4 data sets

| Input                | Output          |
|----------------------|-----------------|
| CO2                  | life_expectancy |
| mean_years_in_school | income          |

**Merge data**

```{r}
final_8 <- merger(c(
  "mean_years_in_school",
  "CO2",
  "life_expectancy",
  "income"
))

nrow(final_8)
```

-\> **5865** DMUs

**Check for 0 values**

```{r}
# min(final_8$women_in_parliament)
# min(final_8$forest_area)
min(final_8$mean_years_in_school)
# min(final_8$poverty)
min(final_8$CO2)
```

0 values in mean years in school and CO2

```{r}
print("0 mean years in school:")
check0(final_8$mean_years_in_school)
print("0 CO2:")
check0(final_8$CO2)
```

One entry with 0 years of education (Yemen) and one entry with 0 CO2
emissions (Iran)

-\> I will delete them

```{r}
final_8 <- subset(final_8, (mean_years_in_school != 0 & CO2 != 0))
```

**Export to csv**

```{r}
write_final(final_8)
```

## Attempt 7 - 5 data sets

| Input                | Output          |
|----------------------|-----------------|
| electricity          | life_expectancy |
| mean_years_in_school | income          |
|                      | CO2             |

**Merge data**

```{r}
final_7 <- merger(c(
  "electricity",
  "mean_years_in_school",
  "CO2",
  "life_expectancy",
  "income" 
))

nrow(final_7)
```

-\> **4286** DMUs

**Check for 0 values**

```{r}
# min(final_7$women_in_parliament)
# min(final_7$forest_area)
min(final_7$mean_years_in_school)
# min(final_7$poverty)
min(final_7$CO2)
```

No 0 values :D

**Export to csv**

```{r}
write_final(final_7)
```

## Attempt 6 - 5 data sets

| Input           | Output          |
|-----------------|-----------------|
| electricity     | life_expectancy |
| employment_rate | income          |
|                 | CO2             |

**Merge data**

```{r}
final_6 <- merger(c(
  "electricity",
  "employment_rate",
  "CO2",
  "life_expectancy",
  "income"
))

nrow(final_6)
```

-\> **4421** DMUs

**Check for 0 values**

```{r}
min(final_6$CO2)
```

No 0 values !!

**Export to csv**

```{r}
write_final(final_6)
```

## Attempt 5 - 5 data sets

| Input         | Output          |
|---------------|-----------------|
| electricity   | life_expectancy |
| health_worker | income          |
|               | CO2             |

**Merge data**

```{r}
final_5 <- merger(c(
  "electricity",
  "health_worker",
  "CO2",
  "life_expectancy",
  "income"
))

nrow(final_5)
```

-\> **2049** DMUs

**Check for 0 values**

```{r}
min(final_5$CO2)
```

No 0 values :)

**Export to csv**

```{r}
write_final(final_5)
```

## Attempt 4 - 6 data sets

| Input               | Output          |
|---------------------|-----------------|
| electricity         | life_expectancy |
| women_in_parliament | income          |
| health_worker       | CO2             |

**Merge data**

```{r}
final_4 <- merger(c(
  "women_in_parliament",
  "electricity",
  "CO2",
  "life_expectancy",
  "income",
  "health_worker"
))

nrow(final_4)
```

-\> **2465** DMUs

**Check for 0 values**

```{r}
min(final_4$women_in_parliament)
# min(final_4$forest_area)
# min(final$mean_years_in_school)
# min(final$poverty)
min(final_4$CO2)
```

```{r}
print("0 women in parliament:")
check0(final_4)
```

Assign very low values where values are 0

```{r}
final_4[final_4 == 0] <- 0.001
```

```{r}
min(final_4$women_in_parliament)
# min(final_4$forest_area)
# min(final$mean_years_in_school)
# min(final$poverty)
min(final_4$CO2)
```

Export to csv

```{r}
write_final(final_4)
```

## Attempt 3 - 8 data sets

| Input               | Output          |
|---------------------|-----------------|
| electricity         | life_expectancy |
| forest_area         | income          |
| women_in_parliament | CO2             |
| health_worker       | employment_rate |

**Merge data**

```{r}
final_3 <- merger(c(
  "women_in_parliament",
  "electricity",
  "CO2",
  "forest_area",
  "life_expectancy",
  "income",
  "health_worker",
  "employment_rate"
))

nrow(final_3)
```

-\> **2316** DMUs

**Check for 0 values**

```{r}
min(final_3$women_in_parliament)
min(final_3$forest_area)
# min(final$mean_years_in_school)
# min(final$poverty)
min(final_3$CO2)
```

0 values in women in parliament and forest area

```{r}
print("0 women in parliament:")
check0(final_3$women_in_parliament)
print("0 forest area:")
check0(final_3$forest_area)
```

Assign very low values where values are 0

```{r}
final_3[final_3 == 0] <- 0.001
```

**Export to csv**

```{r}
write_csv(final_3, "D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/processed_data/final_3.csv")
```

## Attempt 2 - 8 data sets

In this attempt we try to cover only 8 dimensions in total.

| Input                | Output          |
|----------------------|-----------------|
| women_in_parliament  | life_expectancy |
| electricity          | income          |
| CO2                  | income_share_20 |
| mean_years_in_school | employment_rate |

```{r}
final_2 <- merger(c(
  "women_in_parliament",
  "electricity",
  "CO2",
  "mean_years_in_school",
  "life_expectancy",
  "income",
  "income_share_20",
  "employment_rate"
))

nrow(final_2)
```

Check for 0 values

```{r}
min(final_2$women_in_parliament)
min(final_2$mean_years_in_school)
min(final_2$CO2)
```

Count how many 0 values in women in parliament

```{r}
sum(final_2$women_in_parliament <= 0)
```

Only 3 values 0 or less. I will delete these 3 observations.

```{r}
final_2 <- subset(final_2, women_in_parliament>0)
```

```{r}
nrow(final_2)
```

1331 DMUs -\> Very few

```{r}
write_final(final_3)
```

## Attempt 1 - All data sets

### Are there any quirks in the resulting data frame?

-   Upper middle income
-   World
-   USSR

-\> OurWorldInData also shows regional data, Gapminder does not. When
filtering out all country-year combinations with NA values, the regional
data will be filtered out as well. We will check that later.

### Delete DMUs with NAs

```{r}
final_1 <- drop_na(general)
```

### Check for negative or zero values

```{r}
min(final_1$women_in_parliament)
min(final_1$forest_area)
min(final_1$mean_years_in_school)
min(final_1$poverty)
min(final_1$CO2)
```

In the poverty column many 0 values can be found. Instead of just
deleting the columns, I will do the merger again but without poverty.

0 values in women in parliament as well, but only one -\> delete this
value

```{r}
nrow(final_1)

final_1 <- merger(c(
  "dmu",
  "women_in_parliament",
  "basic_sanitation",
  "basic_water_source",
  "electricity",
  "employment_rate",
  "material_footprint",
  "forest_area",
  "mean_years_in_school",
  "air_pollution",
  "health_worker",
  "red_list",
  # "poverty",
  "life_expectancy",
  "income",
  "income_share_20",
  "CO2",
  "murder"
))

nrow(final_1)
```

As we can see, we did not get any more DMUs by not including poverty.
What a shame. 279 DMUs are way too less for 16 Dimensions. We need to
have less dimensions.

```{r}
check0(final_1)
```

```{r}
final_1 <- filter(final_1, final_1$women_in_parliament > 0)
```

### Save result as csv

```{r}
write_csv(final_1, "D:/Daten/Bildung/HS Mannheim/BA/bachelors-thesis/processed_data/final_1.csv")
```

## 
